<!DOCTYPE html>
<html lang="en">
<head>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-C4NE6WWP8F"></script>
    <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-C4NE6WWP8F');
    </script>
    
    <meta charset="utf-8">
    <title>PhloxTools Download - Installation Guide</title>
    <meta content="width=device-width, initial-scale=1.0" name="viewport">
    <meta content="PhloxTools Download and Installation Guide" name="description">
    <meta content="PhloxTools, Revit, Automation, pyRevit" name="keywords">

    <!-- Favicon -->
    <link href="img/favicon.ico" rel="icon">

    <!-- Google Web Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">

    <!-- Icon Font Stylesheet -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.10.0/css/all.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.4.1/font/bootstrap-icons.css" rel="stylesheet">

    <!-- Libraries Stylesheet -->
    <link href="lib/animate/animate.min.css" rel="stylesheet">
    <link href="lib/owlcarousel/assets/owl.carousel.min.css" rel="stylesheet">

    <!-- Customized Bootstrap Stylesheet -->
    <link href="css/bootstrap.min.css" rel="stylesheet">

    <!-- Template Stylesheet -->
    <link href="css/style.css" rel="stylesheet">
</head>

<body>
    <!-- Spinner Start -->
    <div id="spinner" class="show bg-white position-fixed translate-middle w-100 vh-100 top-50 start-50 d-flex align-items-center justify-content-center">
        <div class="spinner-border text-primary" style="width: 3rem; height: 3rem;" role="status">
            <span class="sr-only">Loading...</span>
        </div>
    </div>
    <!-- Spinner End -->

    <!-- Navbar Start -->
    <nav class="navbar navbar-expand-lg bg-white navbar-light sticky-top px-4 px-lg-5">
        <a href="index.html" class="navbar-brand d-flex align-items-center">
            <h1 class="m-0 text-primary">Phlox Engineering</h1>
        </a>
        <button type="button" class="navbar-toggler" data-bs-toggle="collapse" data-bs-target="#navbarCollapse">
            <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarCollapse">
            <div class="navbar-nav ms-auto py-4 py-lg-0">
                <a href="index.html" class="nav-item nav-link">Home</a>
                <a href="about.html" class="nav-item nav-link">About</a>
                <a href="services.html" class="nav-item nav-link">Services</a>
                <a href="portfolio.html" class="nav-item nav-link">Portfolio</a>
                <a href="contact.html" class="nav-item nav-link">Contact</a>
            </div>
        </div>
    </nav>
    <!-- Navbar End -->

    <!-- Header Start -->
    <div class="container-fluid bg-primary py-5 mb-5 hero-header">
        <div class="container py-5">
            <div class="row justify-content-center">
                <div class="col-lg-10 text-center">
                    <h1 class="display-3 text-white mb-4 animated slideInDown">PhloxTools Download</h1>
                    <p class="text-white mb-4 animated slideInDown">Download the installer and follow the guide below.</p>
                </div>
            </div>
        </div>
    </div>
    <!-- Header End -->

    <!-- Download Section Start -->
    <div class="container-fluid py-5">
        <div class="container">
            <div class="row g-5">
                <div class="col-lg-8 mx-auto">
                    <div class="bg-light rounded p-5">
                        <h2 class="text-primary mb-4">Download PhloxTools</h2>
                        <div class="alert alert-warning d-flex align-items-start" role="alert">
                            <i class="fas fa-exclamation-triangle me-3 mt-1"></i>
                            <div>
                                <strong>Before you download:</strong>
                                <ol class="mb-0 mt-2">
                                    <li>Install pyRevit (Step 1 below)</li>
                                    <li>Enable the Bundles Creator extension in pyRevit (Step 2 below)</li>
                                </ol>
                                <p class="mb-0 mt-2 small">Once Steps 1 & 2 are done, you can run the installer in Step 3.</p>
                            </div>
                        </div>

                        <div class="alert alert-info d-flex align-items-start" role="alert">
                            <i class="fas fa-shield-alt me-3 mt-1"></i>
                            <div>
                                <strong>Heads up about your browser:</strong>
                                <p class="mb-0">Your browser may flag the download as suspicious. This is common for new products that aren't yet widely distributed. The installer is safe to run.</p>
                            </div>
                        </div>

                        <div class="row mb-3">
                            <div class="col-md-6">
                                <label for="userEmail" class="form-label">Email Address <span class="text-danger">*</span></label>
                                <input type="email" class="form-control" id="userEmail" placeholder="your.email@company.com" required>
                            </div>
                            <div class="col-md-6">
                                <label for="companyName" class="form-label">Company Name <span class="text-danger">*</span></label>
                                <input type="text" class="form-control" id="companyName" placeholder="Your Company Name" required>
                            </div>
                        </div>

                        <div class="form-check mb-3">
                            <input class="form-check-input" type="checkbox" value="" id="prereqConfirm">
                            <label class="form-check-label" for="prereqConfirm">
                                I have completed Steps 1 & 2 below (pyRevit installed and Bundles Creator enabled)
                            </label>
                        </div>

                        <div class="form-check mb-3">
                            <input class="form-check-input" type="checkbox" value="" id="eulaAgree">
                            <label class="form-check-label" for="eulaAgree">
                                I agree to the <a href="#" data-bs-toggle="modal" data-bs-target="#eulaModal" class="text-primary">End User License Agreement</a>
                            </label>
                        </div>

                        <div class="text-center mb-5">
                            <div class="mb-3">
                                <span class="badge bg-success fs-6 px-3 py-2">
                                    <i class="fas fa-tag me-2"></i>Version 1.1.1
                            </div>
                            <a href="PhloxToolsInstaller.exe" id="downloadBtn" class="btn btn-primary btn-lg px-5 py-3 rounded-pill disabled" download aria-disabled="true">
                                <i class="fas fa-download me-2"></i>Download PhloxToolsInstaller.exe
                            </a>
                        </div>
                        
                        <h3 class="text-primary mb-4">INSTALLATION GUIDE</h3>
                        
                        <div class="mb-4">
                            <h4 class="text-secondary mb-3">1. pyRevit Installation</h4>
                            <p>pyRevit installation guide can be found here:</p>
                            <p><a href="https://github.com/pyrevitlabs/pyRevit/releases" target="_blank" class="text-primary">https://github.com/pyrevitlabs/pyRevit/releases</a></p>
                            <p>Where you should select the most recent Installer file (the first one will work only for your account, the second will add it to all user systems if you're an admin).</p>
                            <p>Then follow the remaining instructions found in the first link (installation guide). If it asks about "Bundles Creator Extension" and "developer extension", include it in the install.</p>
                        </div>

                        <div class="mb-4">
                            <h4 class="text-secondary mb-3">2. Setting up pyRevit and buttons</h4>
                            <p>In the bottom left of the pyRevit tab, there's a drop-down menu simply called "pyRevit". When pressed, you'll see a ribbon with many buttons. On the bottom left of the ribbon, there's a dropdown marked "pyRevit", in which you'll see a puzzle piece marked "Extensions". Pressing that will open a window marked pyRevit Extension Manager. Make sure the highlighted Bundles Creator extension is installed and enabled, which will make the "pyRevit Bundles Creator" tab appear in the top ribbon.</p>
                        </div>

                        <div class="mb-4">
                            <h4 class="text-secondary mb-3">3. Run the installer</h4>
                            <p>Download and run PhloxToolsInstaller.exe. After restarting Revit, a new ribbon tab marked PhloxTools will appear, containing the buttons. These files will live with the other extensions in your computer here:</p>
                            <p><code>C:\Users\yourUserName\AppData\Roaming\pyRevit-Master\extensions</code></p>
                        </div>

                        <div class="mb-4">
                            <h4 class="text-secondary mb-3">4. Using the buttons</h4>
                            <p>The tools make an important assumption that there exists a primary corridor or hallway (labeled one of "CORRIDOR", "HALLWAY", "HALL", "CORR", "MAIN HALL", "VESTIBULE"), and that it is already numbered. The first number of corridor is used to identify the floor number that guides all the other numbers (e.g. 101, 102 derived from the corridor being labeled 100.)</p>
                            
                            <h5 class="text-secondary mt-4 mb-2">The Segments button</h5>
                            <p>asks you how many corridor segments there are in the hallway, and you must manually select the start and end points of the hallway. Always try to start and end in the centerline of the hallway. For T-shapes, I recommend starting at the wall-end of the leg, stopping in the middle of the segment just before the turn, then starting the new segment at one end of the T and going to the other end.</p>
                            
                            <h5 class="text-secondary mt-4 mb-2">The Selection button</h5>
                            <p>lets you manually select the doors in the order desired. This is a good fallback if the segments button doesn't want to work for you. It automatically detects all of the doors directly connected between the corridor and the room doors. The program assumes that all doors you want numbered open to something with "room" in the name, as in "bedroom" and "living room".</p>
                            <p>You should also select any stairwell doors and other misc. doors, as they are also automatically detected as connecting the main corridor to an inner room. Stairwells are detected by being labeled as "Stairwell A" or "Stairwell B", and their doors are labeled "A1" or "B2", depending on floor. Doors connecting to rooms like laundry or vending machines will be labeled based on the name given.</p>
                            <p><strong>Note:</strong> If you've named a room "laundry room", it will be treated as a regularly numbered unit because it has "room" in the name.</p>
                            <p>The current version numbers inner rooms/doors with increasing alphabetic letters (101A, 101B, etc.). Future versions may include flexibility for different methods (e.g. 101.1, 101.2).</p>
                        </div>

                        <div class="alert alert-info mt-5">
                            <h5 class="alert-heading">Need Help?</h5>
                            <p class="mb-0">If you encounter any issues during installation or use, please don't hesitate to contact us at <a href="mailto:josh@phloxengineering.com" class="alert-link">josh@phloxengineering.com</a> or schedule a consultation.</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- Download Section End -->

    <!-- EULA Modal Start -->
    <div class="modal fade" id="eulaModal" tabindex="-1" aria-labelledby="eulaModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg modal-dialog-scrollable">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="eulaModalLabel">End User License Agreement</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="mb-3">
                        <h6 class="text-primary">PhloxTools End User License Agreement</h6>
                        <p class="small text-muted">Version 1.1.1 - Effective Date: <span id="currentDate"></span></p>
                    </div>
                    
                    <div class="eula-content" style="max-height: 400px; overflow-y: auto; padding-right: 10px;">
                        <h6>1. License Grant</h6>
                        <p>Phlox Engineering ("Licensor") hereby grants to the purchasing company ("Licensee") a non-exclusive, non-transferable license to use PhloxTools software ("Software") for the Licensee's internal business purposes.</p>
                        
                        <h6>2. Permitted Use</h6>
                        <p>The Licensee may use the Software for:</p>
                        <ul>
                            <li>Internal business operations and projects</li>
                            <li>Revenue-generating activities of the Licensee's business</li>
                            <li>Standard architectural and engineering workflows</li>
                        </ul>
                        
                        <h6>3. Permitted Modifications</h6>
                        <p>The Licensee may modify the Software for internal use only, including:</p>
                        <ul>
                            <li>Customizing the Software to meet specific internal business needs</li>
                            <li>Creating internal modifications, enhancements, or adaptations</li>
                            <li>Integrating the Software with other internal systems</li>
                        </ul>
                        
                        <h6>4. Prohibited Uses</h6>
                        <p>The Licensee may NOT:</p>
                        <ul>
                            <li>Resell, redistribute, or transfer the Software (original or modified) to any third party</li>
                            <li>Distribute, sell, or commercialize any modified versions of the Software</li>
                            <li>Create derivative works based on the Software for external distribution or commercial sale</li>
                            <li>Use the Software to create competing products or services for external markets</li>
                            <li>Reverse engineer the Software for the purpose of creating competing products</li>
                        </ul>
                        
                        <h6>5. Intellectual Property</h6>
                        <p>The Software and all related intellectual property rights remain the exclusive property of Phlox Engineering. This license does not grant any ownership rights to the Licensee. Any modifications made by the Licensee for internal use do not transfer ownership of the underlying Software.</p>
                        
                        <h6>6. Disclaimer of Warranties</h6>
                        <p>THE SOFTWARE IS PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE, AND NONINFRINGEMENT.</p>
                        
                        <h6>7. Limitation of Liability</h6>
                        <p>IN NO EVENT SHALL PHLOX ENGINEERING BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, CONSEQUENTIAL, OR PUNITIVE DAMAGES ARISING OUT OF OR RELATING TO THE USE OR INABILITY TO USE THE SOFTWARE, INCLUDING BUT NOT LIMITED TO DAMAGES FOR LOSS OF PROFITS, DATA, OR OTHER INTANGIBLE LOSSES.</p>
                        
                        <h6>8. Indemnification</h6>
                        <p>The Licensee agrees to indemnify and hold harmless Phlox Engineering from any claims, damages, or expenses arising from the Licensee's use of the Software.</p>
                        
                        <h6>9. Termination</h6>
                        <p>This license may be terminated immediately upon breach of any terms herein. Upon termination, the Licensee must cease all use of the Software and destroy all copies.</p>
                        
                        <h6>10. Governing Law</h6>
                        <p>This agreement shall be governed by the laws of the Commonwealth of Kentucky, United States of America, without regard to conflict of law principles.</p>
                        
                        <h6>11. Entire Agreement</h6>
                        <p>This agreement constitutes the entire understanding between the parties and supersedes all prior agreements relating to the Software.</p>
                        
                        <div class="alert alert-warning mt-3">
                            <strong>By downloading and using PhloxTools, you acknowledge that you have read, understood, and agree to be bound by the terms of this End User License Agreement.</strong>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>
    <!-- EULA Modal End -->

    <!-- Cookie Consent Banner -->
    <div id="cookieConsent" class="alert alert-info alert-dismissible fade show position-fixed bottom-0 start-0 end-0 m-0 rounded-0" style="z-index: 1050; display: none;">
        <div class="container">
            <div class="row align-items-center">
                <div class="col-md-8">
                    <strong>🍪 We use cookies</strong> to analyze site traffic and improve your experience. By continuing to use this site, you consent to our use of cookies.
                </div>
                <div class="col-md-4 text-end">
                    <button type="button" class="btn btn-primary btn-sm me-2" onclick="acceptCookies()">Accept</button>
                    <button type="button" class="btn btn-outline-secondary btn-sm" onclick="declineCookies()">Decline</button>
                </div>
            </div>
        </div>
    </div>
    <!-- Cookie Consent Banner End -->

    <!-- Footer Start -->
    <div class="container-fluid bg-dark text-white py-5">
        <div class="container">
            <div class="row g-5">
                <div class="col-lg-4">
                    <h4 class="text-white mb-4">Phlox Engineering</h4>
                    <p class="mb-4">Eliminating repetitive tasks so you can focus on what you do best.</p>
                    <div class="d-flex pt-3">
                        <a href="https://www.linkedin.com/in/joshua-nielsen-phd-40a185113/" class="btn btn-square btn-primary me-2" target="_blank"><i class="fab fa-linkedin-in"></i></a>
                    </div>
                </div>
                <div class="col-lg-4">
                    <h4 class="text-white mb-4">Quick Links</h4>
                    <a class="btn btn-link text-white-50" href="about.html">About</a>
                    <a class="btn btn-link text-white-50" href="services.html">Services</a>
                    <a class="btn btn-link text-white-50" href="portfolio.html">Portfolio</a>
                    <a class="btn btn-link text-white-50" href="contact.html">Contact</a>
                </div>
                <div class="col-lg-4">
                    <h4 class="text-white mb-4">Contact Info</h4>
                    <p class="mb-2"><i class="fa fa-envelope me-3"></i>josh@phloxengineering.com</p>
                    <p class="mb-0"><i class="fa fa-phone me-3"></i>+1 (502) 509-XXXX</p>
                </div>
            </div>
        </div>
        <div class="container">
            <div class="copyright">
                <div class="row">
                    <div class="col-md-6 text-center text-md-start mb-3 mb-md-0">
                        &copy; <a class="border-bottom" href="#">Phlox Engineering</a>, All Right Reserved.
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- Footer End -->

    <!-- Back to Top -->
    <a href="#" class="btn btn-lg btn-primary btn-lg-square rounded-circle back-to-top"><i class="bi bi-arrow-up"></i></a>

    <!-- JavaScript Libraries -->
    <script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="lib/wow/wow.min.js"></script>
    <script src="lib/easing/easing.min.js"></script>
    <script src="lib/waypoints/waypoints.min.js"></script>
    <script src="lib/owlcarousel/owl.carousel.min.js"></script>

    <!-- Template Javascript -->
    <script src="js/main.js"></script>
    <script>
    (function() {
        // Set current date for EULA
        document.getElementById('currentDate').textContent = new Date().toLocaleDateString();
        
        const prereqCheckbox = document.getElementById('prereqConfirm');
        const eulaCheckbox = document.getElementById('eulaAgree');
        const downloadBtn = document.getElementById('downloadBtn');
        const emailInput = document.getElementById('userEmail');
        const companyInput = document.getElementById('companyName');
        
        if (!prereqCheckbox || !eulaCheckbox || !downloadBtn || !emailInput || !companyInput) return;
        
        const validateForm = () => {
            const emailValid = emailInput.value.trim() !== '' && emailInput.checkValidity();
            const companyValid = companyInput.value.trim() !== '';
            const prereqValid = prereqCheckbox.checked;
            const eulaValid = eulaCheckbox.checked;
            
            return emailValid && companyValid && prereqValid && eulaValid;
        };
        
        const toggleDownloadButton = () => {
            if (validateForm()) {
                downloadBtn.classList.remove('disabled');
                downloadBtn.removeAttribute('aria-disabled');
            } else {
                downloadBtn.classList.add('disabled');
                downloadBtn.setAttribute('aria-disabled', 'true');
            }
        };
        
        // Handle EULA agreement logging
        const logEulaAgreement = async () => {
            try {
                const response = await fetch('/.netlify/functions/log-eula-agreement', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        timestamp: new Date().toISOString(),
                        userAgent: navigator.userAgent,
                        ip: await fetch('https://api.ipify.org?format=json').then(r => r.json()).then(data => data.ip).catch(() => 'unknown'),
                        version: '1.1.1',
                        email: emailInput.value.trim(),
                        company: companyInput.value.trim()
                    })
                });
                
                if (response.ok) {
                    console.log('EULA agreement logged successfully');
                } else {
                    console.warn('Failed to log EULA agreement');
                }
            } catch (error) {
                console.warn('Error logging EULA agreement:', error);
            }
        };
        
        // Event listeners
        prereqCheckbox.addEventListener('change', toggleDownloadButton);
        eulaCheckbox.addEventListener('change', async (e) => {
            if (e.target.checked) {
                await logEulaAgreement();
            }
            toggleDownloadButton();
        });
        emailInput.addEventListener('input', toggleDownloadButton);
        companyInput.addEventListener('input', toggleDownloadButton);
        
        // Initial state
        toggleDownloadButton();
    })();

    // Cookie consent functions
    function acceptCookies() {
        localStorage.setItem('cookieConsent', 'accepted');
        document.getElementById('cookieConsent').style.display = 'none';
        // Enable Google Analytics
        gtag('consent', 'update', {
            'analytics_storage': 'granted'
        });
    }

    function declineCookies() {
        localStorage.setItem('cookieConsent', 'declined');
        document.getElementById('cookieConsent').style.display = 'none';
        // Disable Google Analytics
        gtag('consent', 'update', {
            'analytics_storage': 'denied'
        });
    }

    // Check cookie consent on page load
    document.addEventListener('DOMContentLoaded', function() {
        const consent = localStorage.getItem('cookieConsent');
        if (!consent) {
            document.getElementById('cookieConsent').style.display = 'block';
        }
    });
    </script>
</body>
</html> 